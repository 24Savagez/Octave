%% Introduction to image processing workshop - semester two%% You can run this code and check the results in the "Command Window"%% Mathematical morphology image function%%   /\%%  /!!\%% /!!!!\  Make sure that you load the image package using%%/______\ "pkg load image"%% Basic examples of Mathematical morphology: cameraman image%% Made by Romuald Jolivot for BU introduction to image processing workshop % Clear all previous data use clear function and closing all potential windows using close function for all dataclear all, close all%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Load image into a variable%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Load an image using dialog box function uigetfile% uigetfile function to get the file path and file name%[filename, filepath]=uigetfile({"*.png;*.jpg","Choose cameraman image to load"});% load the image using file path and file name put into squared bracked and separated with a comma ,%Im = imread([filepath,filename]);%% Load an image with the file name Im = imread("cameraman.jpg");%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Structuring element: square% Size 3SESQ3=strel("square",3);% Size 5SESQ5=strel("square",5);% Size 7SESQ7=strel("square",7);% Apply erosion using square with different size% Erosion Square 3ImErSq3 = imerode(Im,SESQ3);% Erosion Square 5ImErSq5 = imerode(Im,SESQ5);% Erosion Square 3ImErSq7 = imerode(Im,SESQ7);% Display the results for Erosion Square 3figure(1)subplot(2,2,1)imshow(Im)title("Original Image")subplot(2,2,2)imshow(ImErSq3)title("Erosion Square 3")subplot(2,2,3)imshow(ImErSq5)title("Erosion Square 5")subplot(2,2,4)imshow(ImErSq7)title("Erosion Square 7")% Apply dilation using square with different size% Dilation Square 3ImDiSq3 = imdilate(Im,SESQ3);% Dilation Square 5ImDiSq5 = imdilate(Im,SESQ5);% Dilation Square 3ImDiSq7 = imdilate(Im,SESQ7);% Display the results for Dilation Square size 3, 5, 7figure(2)subplot(2,2,1)imshow(Im)title("Original Image")subplot(2,2,2)imshow(ImDiSq3)title("Dilation Square 3")subplot(2,2,3)imshow(ImDiSq5)title("Dilation Square 5")subplot(2,2,4)imshow(ImDiSq7)title("Dilation Square 7")% Apply opening using square with different size% Opening Square 3ImOpSq3 = imopen(Im,SESQ3);% Opening Square 5ImOpSq5 = imopen(Im,SESQ5);% Opening Square 3ImOpSq7 = imopen(Im,SESQ7);% Display the results for opening Square size 3, 5, 7figure(3)subplot(2,2,1)imshow(Im)title("Original Image")subplot(2,2,2)imshow(ImOpSq3)title("Opening Square 3")subplot(2,2,3)imshow(ImOpSq5)title("Opening Square 5")subplot(2,2,4)imshow(ImOpSq7)title("Opening Square 7")% Apply closing using square with different size% Closing Square 3ImClSq3 = imclose(Im,SESQ3);% Closing Square 5ImClSq5 = imclose(Im,SESQ5);% Closing Square 3ImClSq7 = imclose(Im,SESQ7);% Display the results for Closing Square size 3, 5, 7figure(4)subplot(2,2,1)imshow(Im)title("Original Image")subplot(2,2,2)imshow(ImClSq3)title("Closing Square 3")subplot(2,2,3)imshow(ImClSq5)title("Closing Square 5")subplot(2,2,4)imshow(ImClSq7)title("Closing Square 7")%% Applying erosion twiceImErSq3_2 = imerode(ImErSq3,SESQ3);figure(5)subplot(1,3,1)imshow(Im)title("Original Image")subplot(1,3,2)imshow(ImErSq3)title("Erosion Square 3")subplot(1,3,3)imshow(ImErSq3)title("Erosion Square 3 x2")%% Applying dilation twiceImDiSq3_2 = imdilate(ImDiSq3,SESQ3);figure(6)subplot(1,3,1)imshow(Im)title("Original Image")subplot(1,3,2)imshow(ImDiSq3)title("Dilation Square 3")subplot(1,3,3)imshow(ImDiSq3_2)title("Dilation Square 3 x2")%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Add salt and pepper noiseImAddNoise = imnoise(double(Im), "salt & pepper",0.02);% Apply erosion using square with different size% Erosion Square 3ImErSq3Noise = imerode(ImAddNoise,SESQ3);% Erosion Square 5ImErSq5Noise = imerode(ImAddNoise,SESQ5);% Erosion Square 3ImErSq7Noise = imerode(ImAddNoise,SESQ7);% Display the results for Erosion Square 3figure(7)subplot(2,2,1)imshow(ImAddNoise)title("Noisy Image")subplot(2,2,2)imshow(ImErSq3Noise)title("Erosion Square 3")subplot(2,2,3)imshow(ImErSq5Noise)title("Erosion Square 5")subplot(2,2,4)imshow(ImErSq7Noise)title("Erosion Square 7")% Apply dilation using square with different size% Dilation Square 3ImDiSq3Noise = imdilate(ImAddNoise,SESQ3);% Dilation Square 5ImDiSq5Noise = imdilate(ImAddNoise,SESQ5);% Dilation Square 3ImDiSq7Noise = imdilate(ImAddNoise,SESQ7);% Display the results for Dilation Square size 3, 5, 7figure(8)subplot(2,2,1)imshow(ImAddNoise)title("Noisy Image")subplot(2,2,2)imshow(ImDiSq3Noise)title("Dilation Square 3")subplot(2,2,3)imshow(ImDiSq5Noise)title("Dilation Square 5")subplot(2,2,4)imshow(ImDiSq7Noise)title("Dilation Square 7")% Apply opening using square with different size% Opening Square 3ImOpSq3Noise = imopen(ImAddNoise,SESQ3);% Opening Square 5ImOpSq5Noise = imopen(ImAddNoise,SESQ5);% Opening Square 3ImOpSq7Noise = imopen(ImAddNoise,SESQ7);% Display the results for opening Square size 3, 5, 7figure(9)subplot(2,2,1)imshow(ImAddNoise)title("Noisy Image")subplot(2,2,2)imshow(ImOpSq3Noise)title("Opening Square 3")subplot(2,2,3)imshow(ImOpSq5Noise)title("Opening Square 5")subplot(2,2,4)imshow(ImOpSq7Noise)title("Opening Square 7")% Apply closing using square with different size% Closing Square 3ImClSq3Noise = imclose(ImAddNoise,SESQ3);% Closing Square 5ImClSq5Noise = imclose(ImAddNoise,SESQ5);% Closing Square 3ImClSq7Noise = imclose(ImAddNoise,SESQ7);% Display the results for Closing Square size 3, 5, 7figure(10)subplot(2,2,1)imshow(ImAddNoise)title("Noisy Image")subplot(2,2,2)imshow(ImClSq3Noise)title("Closing Square 3")subplot(2,2,3)imshow(ImClSq5Noise)title("Closing Square 5")subplot(2,2,4)imshow(ImClSq7Noise)title("Closing Square 7")%% Applying erosion twiceImErSq3_2Noise = imerode(ImErSq3Noise,SESQ3);figure(11)subplot(1,3,1)imshow(ImAddNoise)title("Noisy Image")subplot(1,3,2)imshow(ImErSq3Noise)title("Erosion Square 3")subplot(1,3,3)imshow(ImErSq3_2Noise)title("Erosion Square 3 x2")%% Applying dilation twiceImDiSq3_2Noise = imdilate(ImDiSq3Noise,SESQ3);figure(12)subplot(1,3,1)imshow(ImAddNoise)title("Noisy Image")subplot(1,3,2)imshow(ImDiSq3Noise)title("Dilation Square 3")subplot(1,3,3)imshow(ImDiSq3_2Noise)title("Dilation Square 3 x2")%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Getting External gradient, Internal gradient and Gradient image% External gradient = Image dilated (with 3x3 square) - Image originalExtGradientIm = ImDiSq3 - Im;% Internal gradien = Image original - Image eroded (with 3x3 square)IntGradientIm = Im - ImErSq3;GradientImage = ExtGradientIm - IntGradientIm;% Display result of gradientsfigure(13)subplot(2,2,1)imshow(Im)title("Original Image")subplot(2,2,2)imshow(ExtGradientIm)title("External Gradient Image")subplot(2,2,3)imshow(IntGradientIm)title("Internal Gradient Image")subplot(2,2,4)imshow(GradientImage)title("Gradient Image")